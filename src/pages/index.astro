---
import BaseLayout from "@/layouts/BaseLayout.astro";

import AbuDhabi from "@/icons/AbuDhabi.astro";
import Australia from "@/icons/Australia.astro";
import Austria from "@/icons/Austria.astro";
import Azerbaijan from "@/icons/Azerbaijan.astro";
import Bahrain from "@/icons/Bahrain.astro";
import Belgium from "@/icons/Belgium.astro";
import Brazil from "@/icons/Brazil.astro";
import Britain from "@/icons/Britain.astro";
import Canada from "@/icons/Canada.astro";
import Emilia from "@/icons/Emilia.astro";
import Hungary from "@/icons/Hungary.astro";
import Italy from "@/icons/Italy.astro";
import Japan from "@/icons/Japan.astro";
import LasVegas from "@/icons/LasVegas.astro";
import Mexico from "@/icons/Mexico.astro";
import Miami from "@/icons/Miami.astro";
import Monaco from "@/icons/Monaco.astro";
import Netherlands from "@/icons/Netherlands.astro";
import Qatar from "@/icons/Qatar.astro";
import SaudiArabia from "@/icons/SaudiArabia.astro";
import Singapore from "@/icons/Singapore.astro";
import Spain from "@/icons/Spain.astro";
import UnitedStates from "@/icons/UnitedStates.astro";

import data from "@/data/f1.json";
import type { RacePrediction } from "@/types";
import TotalPointsCard from "@/components/predictions/TotalPointsCard.astro";

export const CIRCUIT_ICONS: Record<string, any> = {
  AbuDhabi,
  Australia,
  Austria,
  Azerbaijan,
  Bahrain,
  Belgium,
  Brazil,
  Britain,
  Canada,
  Emilia,
  Hungary,
  Italy,
  Japan,
  LasVegas,
  Mexico,
  Miami,
  Monaco,
  Netherlands,
  Qatar,
  SaudiArabia,
  Singapore,
  Spain,
  UnitedStates,
};

const mattRacesPredictions = data.map((season) =>
  season.races.map((race) => race.predictions.matt)
);

const tommyRacesPredictions = data.map((season) =>
  season.races.map((race) => race.predictions.tommy)
);

let mattRacePredictionsPoints2023 = 0;
let tommyRacePredictionsPoints2023 = 0;

mattRacesPredictions[0].forEach((prediction: RacePrediction) => {
  Object.keys(prediction).forEach((key: string) => {
    // @ts-expect-error
    let point: number = prediction[key].point;

    if (point !== null) {
      mattRacePredictionsPoints2023 += point;
    }
  });
});

tommyRacesPredictions[0].forEach((prediction: RacePrediction) => {
  Object.keys(prediction).forEach((key) => {
    // @ts-expect-error
    let point: number = prediction[key].point;

    if (point !== null) {
      tommyRacePredictionsPoints2023 += point;
    }
  });
});

let mattRacePredictionsPoints2024 = 0;
let tommyRacePredictionsPoints2024 = 0;

mattRacesPredictions[1].forEach((prediction: RacePrediction) => {
  Object.keys(prediction).forEach((key: string) => {
    // @ts-expect-error
    let point: number = prediction[key].point;

    if (point !== null) {
      mattRacePredictionsPoints2024 += point;
    }
  });
});

tommyRacesPredictions[1].forEach((prediction: RacePrediction) => {
  Object.keys(prediction).forEach((key) => {
    // @ts-expect-error
    let point: number = prediction[key].point;

    if (point !== null) {
      tommyRacePredictionsPoints2024 += point;
    }
  });
});
---

<BaseLayout title="Matt vs. Tommy">
  <TotalPointsCard
    isNav={true}
    season="2024"
    heading="F1 2024 Season"
    mattRacePredictionsPoints={mattRacePredictionsPoints2024}
    tommyRacePredictionsPoints={tommyRacePredictionsPoints2024}
  />
  <TotalPointsCard
    isNav={true}
    season="2023"
    heading="F1 2023 Season"
    mattRacePredictionsPoints={mattRacePredictionsPoints2023}
    tommyRacePredictionsPoints={tommyRacePredictionsPoints2023}
  />
</BaseLayout>
